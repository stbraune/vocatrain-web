<h3>
  {{'guess.title' | translate}}
</h3>

<mat-card *ngIf="!started" class="margin--bottom">
  <mat-card-content>
    <search-options [supportedLanguages]="supportedLanguages" [(searchOptions)]="searchOptions">
    </search-options>
  </mat-card-content>
  <mat-card-actions>
    <button class="stretch" mat-button (click)="onStartGuessing()">
      {{'guess.start' | translate}}
    </button>
  </mat-card-actions>
</mat-card>

<mat-card *ngIf="finished">
  <mat-card-title>
    {{'guess.finished' | translate}}
  </mat-card-title>
  <mat-card-content>
    <p *ngIf="finishReason === 'no-more-words'">
      {{'guess.no-more-words' | translate}}
    </p>
    <p *ngIf="finishReason === 'reached-amount'">
      {{'guess.reached-amount' | translate}}
    </p>
    <p *ngIf="finishReason === 'reached-minutes'">
      {{'guess.reached-minutes' | translate}}
    </p>
    <p>
      <strong>{{'guess.required-duration' | translate}}:</strong>
      {{duration}}
    </p>
    <p>
      <strong>{{'guess.total-words' | translate}}:</strong>
      {{totalWords}}
    </p>
  </mat-card-content>
</mat-card>

<mat-card *ngIf="started">
  <mat-card-content>
    <div class="flex margin--bottom flex--align-center">
      <div class="flex-col flex-col">
        {{'guess.duration' | translate}}: {{duration}}
        <span *ngIf="searchOptions.mode === 'by-time'">/ {{formatMinutes(searchOptions.minutes)}}</span>
        -
        {{'guess.words' | translate}}: {{totalWords}}
        <span *ngIf="searchOptions.mode === 'by-amount'">/ {{searchOptions.amount}}</span>
      </div>
      <div class="flex-col flex-col--grow flex flex--wrap flex--align-center flex--justify-end">
        <div class="flex-col flex flex--no-margin flex--align-center">
          <div class="key">
            <mat-icon>keyboard_arrow_up</mat-icon>
          </div>
          <span class="margin--left">
            {{'guess.uncover' | translate}}
          </span>
        </div>
        <div class="flex-col flex flex--no-margin flex--align-center margin--left">
          <div class="key">
            <mat-icon>keyboard_arrow_down</mat-icon>
          </div>
          <span class="margin--left">
            {{'guess.cover' | translate}}
          </span>
        </div>
        <div class="flex-col flex flex--no-margin flex--align-center margin--left">
          <div class="key">
            <mat-icon>keyboard_arrow_left</mat-icon>
          </div>
          <span class="margin--left">
            {{'guess.wrong' | translate}}
          </span>
        </div>
        <div class="flex-col flex flex--no-margin flex--align-center margin--left">
          <div class="key">
            <mat-icon>keyboard_arrow_right</mat-icon>
          </div>
          <span class="margin--left">
            {{'guess.right' | translate}}
          </span>
        </div>
      </div>
    </div>
    <div class="flex margin--bottom">
      <div class="flex-col flex-col--grow">
        <strong>{{'guess.last-repeat' | translate}}:</strong>
        <span *ngIf="!currentWord || currentWord.key.answerAt.getTime() === 0; else answerAtOk">
          {{'guess.never' | translate}}
        </span>
        <ng-template #answerAtOk>
          <span>
            {{currentWord.key.answerAt | date:'dd.MM.yy H:mm'}}
          </span>
        </ng-template>
      </div>
      <div class="flex-col flex-col--grow align--right">
        <strong>{{'guess.current-level' | translate}}:</strong>
        <span *ngIf="currentWord; else answerLevelUnknown">
          {{currentWord.key.answerLevel}}
        </span>
        <ng-template #answerLevelUnknown>
          ?
        </ng-template>
      </div>
    </div>
    <div class="flex">
      <mat-card class="align--center flex-col flex-col--50 word-card">
        <mat-card-title *ngIf="currentWord">
          {{currentWord.key.question}}
        </mat-card-title>
        <mat-card-content *ngIf="currentWord">
          <p>
            <strong>{{'guess.language' | translate}}:</strong>
            {{currentWord.key.questionLanguage}}
          </p>
          <p *ngIf="currentWord.key.tags.length > 0">
            <strong>{{'guess.tags' | translate}}:</strong>
            <chips [chips]="currentWord.key.tags" mode="read"></chips>
          </p>
          <p *ngIf="currentWord.key.meta">
            <strong>{{'guess.meta' | translate}}:</strong>
            {{currentWord.key.meta}}
          </p>
        </mat-card-content>
        <mat-card-content *ngIf="!currentWord" class="align--center">
          <div class="display--inline-block">
            <mat-spinner>
            </mat-spinner>
          </div>
        </mat-card-content>
      </mat-card>
      <mat-card class="align--center flex-col flex-col--50 word-card">
        <mat-card-title *ngIf="currentWord && currentWordState >= 1">
          {{currentWord.key.answer}}
        </mat-card-title>
        <mat-card-content *ngIf="currentWord && currentWordState >= 1">
          <p>
            <strong>{{'guess.language' | translate}}:</strong>
            {{currentWord.key.answerLanguage}}
          </p>
          <p *ngIf="currentWord.key.tags.length > 0">
            <strong>{{'guess.tags' | translate}}:</strong>
            <chips [chips]="currentWord.key.tags" mode="read"></chips>
          </p>
        </mat-card-content>
        <mat-card-content *ngIf="!currentWord || currentWordState < 1" class="align--center">
          <div class="display--inline-block">
            <mat-spinner>
            </mat-spinner>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </mat-card-content>
  <mat-card-actions>
    <button mat-button (click)="onStopGuessing()" class="stretch">
      {{'guess.stop' | translate}}
    </button>
  </mat-card-actions>
</mat-card>
